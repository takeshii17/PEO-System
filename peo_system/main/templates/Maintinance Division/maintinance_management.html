{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="{% static 'CSS/styles.css' %}">
  <title>Maintenance Management</title>
  <style>
    :root {
      --bg: #edf1f5;
      --panel: #f8fafc;
      --line: #cfd6de;
      --text: #0f2238;
      --muted: #536982;
      --progress-track: #c7ced6;
      --progress-fill: #132e4d;
      --selected: #f7b333;
      --selected-text: #0f2238;
      --shadow: 0 1px 5px rgba(8, 34, 61, 0.12);
      --radius: 14px;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      min-height: 100%;
      font-family: "Sora", "Segoe UI", sans-serif;
      color: var(--text);
      background: var(--bg);
    }

    .app-shell {
      display: flex;
      min-height: 100vh;
    }

    .sidebar {
      width: 340px;
      background: linear-gradient(180deg, #08274a 0%, #07203f 100%);
      color: #d5dfeb;
      border-right: 1px solid #15385f;
      display: flex;
      flex-direction: column;
    }

    .brand {
      display: flex;
      align-items: center;
      gap: 14px;
      padding: 30px 26px;
      border-bottom: 1px solid rgba(215, 229, 245, 0.16);
    }

    .brand-logo {
      width: 58px;
      height: 58px;
      border-radius: 12px;
      border: 1px solid rgba(207, 220, 235, 0.4);
      background: transparent url("{% static 'images/peo-logo.png' %}") center/contain no-repeat;
      display: grid;
      place-items: center;
      box-shadow: 0 2px 6px rgba(10, 33, 58, 0.25);
    }

    .brand h1 {
      margin: 0;
      font-size: clamp(1.2rem, 1.85vw, 2.05rem);
      color: #f4f7fb;
    }

    .brand p {
      margin: 4px 0 0;
      font-size: 1rem;
      color: #bdcada;
    }

    .nav-menu {
      padding: 20px 16px 24px;
      display: grid;
      gap: 8px;
    }

    .nav-item {
      display: flex;
      align-items: center;
      gap: 12px;
      color: #c7d5e5;
      text-decoration: none;
      border-radius: 14px;
      padding: 14px 16px;
      font-size: clamp(1.05rem, 1.22vw, 2rem);
      line-height: 1.15;
    }

    .nav-item:hover {
      background: rgba(255, 255, 255, 0.08);
    }

    .nav-item.active {
      background: #123760;
      color: #fff;
      box-shadow: inset 0 0 0 1px rgba(189, 214, 238, 0.08);
      font-weight: 600;
    }

    .nav-icon {
      width: 22px;
      height: 22px;
      flex: 0 0 auto;
      opacity: 0.95;
    }

    .workspace {
      flex: 1;
      min-width: 0;
      background: #f2f4f7;
    }

    .topbar {
      height: 92px;
      border-bottom: 1px solid var(--line);
      display: flex;
      align-items: center;
      justify-content: flex-end;
      padding: 0 28px;
      background: #f5f7fa;
    }

    .account {
      display: flex;
      align-items: center;
      gap: 14px;
    }

    .seal {
      width: 52px;
      height: 52px;
      border-radius: 50%;
      border: 2px solid #d2d9e1;
      background: #ffffff url("{% static 'images/prov-logo.png' %}") center/cover no-repeat;
      display: grid;
      place-items: center;
      font-size: 0.56rem;
      font-weight: 700;
      color: #0b2a4c;
      line-height: 1.15;
      text-align: center;
    }

    .avatar {
      width: 42px;
      height: 42px;
      border-radius: 50%;
      background: #0f3459;
      color: #f2f7ff;
      display: grid;
      place-items: center;
      font-size: 1.15rem;
      font-weight: 700;
      text-transform: uppercase;
    }

    .logout-form {
      margin: 0;
    }

    .logout-btn {
      border: 0;
      background: transparent;
      color: #0b213a;
      font-size: 1.05rem;
      cursor: pointer;
      padding: 8px 10px;
      border-radius: 10px;
    }

    .page {
      padding: 24px 28px;
    }

    .maintenance-dashboard {
      max-width: 1700px;
      margin: 0 auto;
      padding: 0;
    }

    .kpi-grid {
      display: grid;
      gap: 16px;
      grid-template-columns: repeat(4, minmax(200px, 1fr));
      margin-bottom: 16px;
    }

    .kpi-card {
      background: var(--panel);
      border: 1px solid var(--line);
      border-radius: 16px;
      box-shadow: var(--shadow);
      min-height: 112px;
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 16px 14px;
    }

    .kpi-icon {
      width: 38px;
      height: 38px;
      border-radius: 12px;
      display: grid;
      place-items: center;
      flex: 0 0 auto;
    }

    .kpi-icon svg {
      width: 22px;
      height: 22px;
    }

    .i-road { background: #dde3ea; color: #173a60; }
    .i-len { background: #d5e2f8; color: #2767de; }
    .i-eq { background: #caecd8; color: #0a9a49; }
    .i-task { background: #f7e8bf; color: #de8500; }

    .kpi-value {
      font-size: clamp(1.6rem, 1.1vw + 1rem, 2.25rem);
      line-height: 1;
      font-weight: 700;
      letter-spacing: -0.02em;
    }

    .kpi-label {
      margin-top: 4px;
      color: var(--muted);
      font-size: clamp(0.88rem, 0.38vw + 0.75rem, 1rem);
      line-height: 1.2;
    }

    .tabs {
      display: inline-flex;
      gap: 2px;
      border-radius: 12px;
      background: #dfe4ea;
      padding: 4px;
      margin-bottom: 10px;
    }

    .tab {
      border: 0;
      background: transparent;
      color: #0d233a;
      font-family: inherit;
      font-size: clamp(0.9rem, 0.42vw + 0.75rem, 1.02rem);
      line-height: 1;
      border-radius: 9px;
      padding: 10px 14px;
      cursor: pointer;
      white-space: nowrap;
    }

    .tab.active {
      background: #f8fafc;
      box-shadow: 0 1px 2px rgba(8, 34, 61, 0.12);
      font-weight: 600;
    }

    .condition-grid {
      display: grid;
      gap: 16px;
      grid-template-columns: repeat(4, minmax(200px, 1fr));
      margin-bottom: 16px;
    }

    .condition-card {
      background: var(--panel);
      border: 1px solid var(--line);
      border-radius: 16px;
      box-shadow: var(--shadow);
      padding: 16px 14px;
    }

    .condition-head {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 8px;
      margin-bottom: 12px;
    }

    .condition-head h3 {
      margin: 0;
      font-size: clamp(0.95rem, 0.55vw + 0.75rem, 1.18rem);
      line-height: 1.15;
      font-weight: 600;
    }

    .badge {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      min-width: 36px;
      border-radius: 999px;
      padding: 4px 10px;
      font-weight: 600;
      font-size: clamp(0.8rem, 0.32vw + 0.68rem, 0.95rem);
      line-height: 1;
    }

    .good { background: #c9efd8; color: #07933f; }
    .fair { background: #cee0f7; color: #2159dc; }
    .poor { background: #f8e6bc; color: #ce7600; }
    .bad { background: #ed3343; color: #ffffff; }

    .progress {
      height: 10px;
      width: 100%;
      border-radius: 999px;
      background: var(--progress-track);
      overflow: hidden;
    }

    .progress > span {
      display: block;
      height: 100%;
      background: var(--progress-fill);
    }

    .p-good { width: 0%; }
    .p-fair { width: 0%; }
    .p-poor { width: 0%; }
    .p-bad { width: 0%; }

    .filter-card {
      background: var(--panel);
      border: 1px solid var(--line);
      border-radius: 16px;
      box-shadow: var(--shadow);
      padding: 18px 14px;
    }

    .filter-row {
      display: grid;
      grid-template-columns: minmax(300px, 2fr) repeat(4, minmax(140px, 1fr));
      gap: 14px;
      align-items: center;
    }

    .search-field {
      display: flex;
      align-items: center;
      gap: 10px;
      border: 1px solid #c8d0d9;
      background: #f8fafc;
      border-radius: 12px;
      padding: 11px 12px;
      min-height: 52px;
    }

    .search-field svg {
      width: 21px;
      height: 21px;
      color: #677c93;
      flex: 0 0 auto;
    }

    .search-field input {
      width: 100%;
      border: 0;
      outline: none;
      background: transparent;
      color: #243d57;
      font-family: inherit;
      font-size: clamp(0.92rem, 0.35vw + 0.78rem, 1.02rem);
      line-height: 1.1;
    }

    .menu-select {
      position: relative;
    }

    .menu-button {
      width: 100%;
      border: 1px solid #c8d0d9;
      border-radius: 12px;
      background: #f8fafc;
      color: #102741;
      min-height: 52px;
      padding: 10px 12px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
      font-family: inherit;
      font-size: clamp(0.92rem, 0.35vw + 0.78rem, 1.02rem);
      line-height: 1.15;
      cursor: pointer;
    }

    .button-label {
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .menu-button svg {
      width: 16px;
      height: 16px;
      color: #8b97a6;
      flex: 0 0 auto;
    }

    .menu-list {
      display: none;
      position: absolute;
      top: calc(100% + 6px);
      left: 0;
      width: 100%;
      min-width: 170px;
      max-height: 260px;
      overflow-y: auto;
      border: 1px solid #c8d0d9;
      border-radius: 10px;
      background: #f8fafc;
      box-shadow: 0 8px 20px rgba(8, 34, 61, 0.18);
      padding: 6px;
      z-index: 20;
    }

    .menu-select.open .menu-list {
      display: block;
    }

    .menu-option {
      width: 100%;
      border: 0;
      background: transparent;
      color: #1f2f40;
      border-radius: 8px;
      min-height: 40px;
      padding: 8px 10px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
      font-family: inherit;
      font-size: clamp(0.92rem, 0.35vw + 0.78rem, 1.02rem);
      line-height: 1.2;
      text-align: left;
      cursor: pointer;
    }

    .menu-option:hover {
      background: #edf1f6;
    }

    .menu-option.active {
      background: var(--selected);
      color: var(--selected-text);
    }

    .option-check {
      opacity: 0;
      font-weight: 700;
    }

    .menu-option.active .option-check {
      opacity: 1;
    }

    @media (max-width: 1280px) {
      .sidebar { width: 280px; }

      .kpi-grid,
      .condition-grid {
        grid-template-columns: repeat(2, minmax(220px, 1fr));
      }

      .filter-row {
        grid-template-columns: repeat(2, minmax(180px, 1fr));
      }

      .search-field {
        grid-column: 1 / -1;
      }
    }

    @media (max-width: 768px) {
      .app-shell { flex-direction: column; }
      .sidebar { width: 100%; }
      .topbar {
        height: auto;
        padding: 12px 16px;
      }
      .page { padding: 12px; }

      .kpi-grid,
      .condition-grid,
      .filter-row {
        grid-template-columns: 1fr;
      }

      .kpi-card {
        min-height: auto;
        padding: 14px 12px;
      }

      .condition-card {
        padding: 14px 12px;
      }

      .filter-card {
        padding: 12px;
      }

      .tabs {
        width: 100%;
        display: flex;
        overflow-x: auto;
      }
    }

    body.embedded-maintenance-view .app-shell {
      display: block;
      min-height: auto;
    }

    body.embedded-maintenance-view .sidebar,
    body.embedded-maintenance-view .topbar {
      display: none;
    }

    body.embedded-maintenance-view .workspace {
      width: 100%;
    }

    body.embedded-maintenance-view .page {
      padding: 16px;
    }
  </style>
</head>
<body{% if request.GET.embedded %} class="embedded-maintenance-view"{% endif %}>
  <div class="app-shell">
    <aside class="sidebar">
      <div class="brand">
        <div class="brand-logo" aria-label="PEO Seal"></div>
        <div>
          <h1>PEO Portal</h1>
          <p>Workflow Management</p>
        </div>
      </div>
      <nav class="nav-menu">
        {% with current_page=request.resolver_match.url_name %}
        <a class="nav-item {% if current_page == 'home' or current_page == 'dashboard' %}active{% endif %}" href="{% url 'home' %}">
          <svg class="nav-icon" viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <rect x="3" y="3" width="7" height="7" rx="1.8" stroke="currentColor" stroke-width="2"/>
            <rect x="14" y="3" width="7" height="7" rx="1.8" stroke="currentColor" stroke-width="2"/>
            <rect x="3" y="14" width="7" height="7" rx="1.8" stroke="currentColor" stroke-width="2"/>
            <rect x="14" y="14" width="7" height="7" rx="1.8" stroke="currentColor" stroke-width="2"/>
          </svg>
          Dashboard
        </a>
        <a class="nav-item {% if current_page == 'admin_div_dashboard' or current_page == 'admin_division' or current_page == 'admin_div_dashboard_legacy' %}active{% endif %}" href="{% url 'admin_div_dashboard' %}"><svg class="nav-icon" viewBox="0 0 24 24" fill="none"><path d="M7 20v-2a4 4 0 0 1 4-4h2a4 4 0 0 1 4 4v2" stroke="currentColor" stroke-width="2"/><circle cx="12" cy="7" r="4" stroke="currentColor" stroke-width="2"/><path d="M3 10c0-1.7 1.3-3 3-3" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>Admin Division</a>
        <a class="nav-item {% if current_page == 'planning_div_dashboard' or current_page == 'planning_division' %}active{% endif %}" href="{% url 'planning_div_dashboard' %}"><svg class="nav-icon" viewBox="0 0 24 24" fill="none"><rect x="5" y="3" width="14" height="18" rx="2" stroke="currentColor" stroke-width="2"/><path d="M9 7h6M9 11h6M9 15h4" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>Planning Division</a>
        <a class="nav-item {% if current_page == 'construction_div_dashboard' or current_page == 'construction_division' %}active{% endif %}" href="{% url 'construction_div_dashboard' %}"><svg class="nav-icon" viewBox="0 0 24 24" fill="none"><path d="M14 5 5 14l-1 5 5-1 9-9-4-4Z" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/><path d="m13 6 4 4" stroke="currentColor" stroke-width="2"/></svg>Construction Division</a>
        <a class="nav-item {% if current_page == 'quality_div_dashboard' or current_page == 'quality_division' %}active{% endif %}" href="{% url 'quality_div_dashboard' %}"><svg class="nav-icon" viewBox="0 0 24 24" fill="none"><path d="M12 3 5 6v6c0 5 3.5 7.5 7 9 3.5-1.5 7-4 7-9V6l-7-3Z" stroke="currentColor" stroke-width="2"/><path d="m9 12 2 2 4-4" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>Quality Division</a>
        <a class="nav-item {% if current_page == 'maintinance_div_dashboard' or current_page == 'maintinance_division' or current_page == 'maintinance_management' or current_page == 'maintenance_div_dashboard' or current_page == 'maintenance_division' or current_page == 'maintenance_management' %}active{% endif %}" href="{% url 'maintinance_div_dashboard' %}"><svg class="nav-icon" viewBox="0 0 24 24" fill="none"><path d="m14 6-8 8 4 4 8-8-4-4Z" stroke="currentColor" stroke-width="2"/><path d="M6 14 4 20l6-2" stroke="currentColor" stroke-width="2"/></svg>Maintenance Division</a>
        <a class="nav-item {% if current_page == 'my_assignments' or current_page == 'my_assignments_template_alias' %}active{% endif %}" href="{% url 'my_assignments' %}"><svg class="nav-icon" viewBox="0 0 24 24" fill="none"><circle cx="12" cy="12" r="9" stroke="currentColor" stroke-width="2"/><path d="m9.5 12 1.7 1.7L15 10" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>My Assignments</a>
        <a class="nav-item {% if current_page == 'maintinance_task_management' or current_page == 'maintenance_task_management' or current_page == 'tasks' %}active{% endif %}" href="{% url 'maintinance_task_management' %}"><svg class="nav-icon" viewBox="0 0 24 24" fill="none"><path d="M4 7h7M4 12h12M4 17h9" stroke="currentColor" stroke-width="2" stroke-linecap="round"/><circle cx="17" cy="7" r="2" stroke="currentColor" stroke-width="2"/></svg>Tasks</a>
        <a class="nav-item {% if current_page == 'maintinance_contractor_management' or current_page == 'maintenance_contractor_management' or current_page == 'contractors' %}active{% endif %}" href="{% url 'maintinance_contractor_management' %}"><svg class="nav-icon" viewBox="0 0 24 24" fill="none"><path d="M3 11h18v8a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-8Z" stroke="currentColor" stroke-width="2"/><path d="M8 11V8a4 4 0 0 1 8 0v3" stroke="currentColor" stroke-width="2"/></svg>Contractors</a>
        {% endwith %}
      </nav>
    </aside>
    <div class="workspace">
      <header class="topbar">
        <div class="account">
          <div class="seal" aria-label="Provincial Logo"></div>
          <div class="avatar">{{ user.username|slice:":1"|upper }}</div>
          <form class="logout-form" action="{% url 'logout' %}" method="post">
            {% csrf_token %}
            <button class="logout-btn" type="submit">Logout</button>
          </form>
        </div>
      </header>
      <main class="page">
        <div class="maintenance-dashboard">
    <section class="kpi-grid" aria-label="Maintenance summary cards">
      <article class="kpi-card">
        <div class="kpi-icon i-road" aria-hidden="true">
          <svg viewBox="0 0 24 24" fill="none"><circle cx="18" cy="6" r="3" stroke="currentColor" stroke-width="2"/><circle cx="6" cy="12" r="3" stroke="currentColor" stroke-width="2"/><circle cx="18" cy="18" r="3" stroke="currentColor" stroke-width="2"/><path d="M8.6 10.8 15.5 7.3M8.6 13.2l6.9 3.5" stroke="currentColor" stroke-width="2"/></svg>
        </div>
        <div>
          <div class="kpi-value">0</div>
          <div class="kpi-label">Provincial Roads</div>
        </div>
      </article>

      <article class="kpi-card">
        <div class="kpi-icon i-len" aria-hidden="true">
          <svg viewBox="0 0 24 24" fill="none"><path d="M12 21s7-5.3 7-11a7 7 0 1 0-14 0c0 5.7 7 11 7 11Z" stroke="currentColor" stroke-width="2"/><circle cx="12" cy="10" r="2.5" stroke="currentColor" stroke-width="2"/></svg>
        </div>
        <div>
          <div class="kpi-value">0 km</div>
          <div class="kpi-label">Total Length</div>
        </div>
      </article>

      <article class="kpi-card">
        <div class="kpi-icon i-eq" aria-hidden="true">
          <svg viewBox="0 0 24 24" fill="none"><rect x="4" y="5" width="9" height="14" rx="2" stroke="currentColor" stroke-width="2"/><path d="M13 11h3l4 4v4h-2a2 2 0 0 1-2-2v-1h-3" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
        </div>
        <div>
          <div class="kpi-value">0</div>
          <div class="kpi-label">Equipment</div>
        </div>
      </article>

      <article class="kpi-card">
        <div class="kpi-icon i-task" aria-hidden="true">
          <svg viewBox="0 0 24 24" fill="none"><rect x="4" y="6" width="16" height="14" rx="2" stroke="currentColor" stroke-width="2"/><path d="M8 3v5M16 3v5M4 10h16" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
        </div>
        <div>
          <div class="kpi-value">0</div>
          <div class="kpi-label">Scheduled Tasks</div>
        </div>
      </article>
    </section>

    <section class="tabs" aria-label="Maintenance dashboard tabs">
      <button type="button" class="tab active">Provincial Roads</button>
      <button type="button" class="tab">Equipment</button>
      <button type="button" class="tab">Maintenance Schedules</button>
    </section>

    <section class="condition-grid" aria-label="Road condition summary">
      <article class="condition-card">
        <div class="condition-head">
          <h3>Good Condition</h3>
          <span class="badge good">0</span>
        </div>
        <div class="progress"><span class="p-good"></span></div>
      </article>

      <article class="condition-card">
        <div class="condition-head">
          <h3>Fair Condition</h3>
          <span class="badge fair">0</span>
        </div>
        <div class="progress"><span class="p-fair"></span></div>
      </article>

      <article class="condition-card">
        <div class="condition-head">
          <h3>Poor Condition</h3>
          <span class="badge poor">0</span>
        </div>
        <div class="progress"><span class="p-poor"></span></div>
      </article>

      <article class="condition-card">
        <div class="condition-head">
          <h3>Bad Condition</h3>
          <span class="badge bad">0</span>
        </div>
        <div class="progress"><span class="p-bad"></span></div>
      </article>
    </section>

    <section class="filter-card" aria-label="Road filters">
      <div class="filter-row">
        <label class="search-field" for="road-search">
          <svg viewBox="0 0 24 24" fill="none" aria-hidden="true"><circle cx="11" cy="11" r="6.5" stroke="currentColor" stroke-width="2"/><path d="M16 16L21 21" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
          <input id="road-search" type="search" placeholder="Search roads..." autocomplete="off">
        </label>

        <div class="menu-select" data-name="municipality">
          <input type="hidden" name="municipality" value="all">
          <button type="button" class="menu-button" aria-expanded="false" aria-haspopup="listbox">
            <span class="button-label">All Municipalities</span>
            <svg viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="m6 9 6 6 6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
          </button>
          <div class="menu-submenu" id="maintenanceSubmenu" aria-hidden="false">
            <a class="menu-subitem" href="{% url 'maintinance_div_dashboard' %}">Maintenance Management</a>
            <a class="menu-subitem" href="{% url 'maintinance_task_management' %}">Task Management</a>
            <a class="menu-subitem" href="{% url 'maintinance_contractor_management' %}">Contractor Management</a>
          </div>
        </div>

        <div class="menu-select" data-name="condition">
          <input type="hidden" name="condition" value="all">
          <button type="button" class="menu-button" aria-expanded="false" aria-haspopup="listbox">
            <span class="button-label">All Conditions</span>
            <svg viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="m6 9 6 6 6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
          </button>
          <div class="menu-list" role="listbox">
            <button type="button" class="menu-option active" data-value="all" data-label="All Conditions"><span>All Conditions</span><span class="option-check">✓</span></button>
            <button type="button" class="menu-option" data-value="good" data-label="Good"><span>Good</span><span class="option-check">✓</span></button>
            <button type="button" class="menu-option" data-value="fair" data-label="Fair"><span>Fair</span><span class="option-check">✓</span></button>
            <button type="button" class="menu-option" data-value="poor" data-label="Poor"><span>Poor</span><span class="option-check">✓</span></button>
            <button type="button" class="menu-option" data-value="bad" data-label="Bad"><span>Bad</span><span class="option-check">✓</span></button>
          </div>
        </div>

        <div class="menu-select" data-name="sort_by">
          <input type="hidden" name="sort_by" value="road_id">
          <button type="button" class="menu-button" aria-expanded="false" aria-haspopup="listbox">
            <span class="button-label">Road ID</span>
            <svg viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="m6 9 6 6 6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
          </button>
          <div class="menu-list" role="listbox">
            <button type="button" class="menu-option active" data-value="road_id" data-label="Road ID"><span>Road ID</span><span class="option-check">✓</span></button>
            <button type="button" class="menu-option" data-value="road_name" data-label="Road Name"><span>Road Name</span><span class="option-check">✓</span></button>
            <button type="button" class="menu-option" data-value="municipality" data-label="Municipality"><span>Municipality</span><span class="option-check">✓</span></button>
            <button type="button" class="menu-option" data-value="length" data-label="Length"><span>Length</span><span class="option-check">✓</span></button>
            <button type="button" class="menu-option" data-value="condition" data-label="Condition"><span>Condition</span><span class="option-check">✓</span></button>
          </div>
        </div>

        <div class="menu-select" data-name="sort_order">
          <input type="hidden" name="sort_order" value="asc">
          <button type="button" class="menu-button" aria-expanded="false" aria-haspopup="listbox">
            <span class="button-label">Ascending</span>
            <svg viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="m6 9 6 6 6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
          </button>
          <div class="menu-list" role="listbox">
            <button type="button" class="menu-option active" data-value="asc" data-label="Ascending"><span>Ascending</span><span class="option-check">✓</span></button>
            <button type="button" class="menu-option" data-value="desc" data-label="Descending"><span>Descending</span><span class="option-check">✓</span></button>
          </div>
        </div>
      </div>
    </section>
        </div>
      </main>
    </div>
  </div>

  <script>
    document.addEventListener("DOMContentLoaded", function () {
      var selects = document.querySelectorAll(".menu-select");

      function closeAll(exceptNode) {
        selects.forEach(function (node) {
          if (node !== exceptNode) {
            node.classList.remove("open");
            var nodeBtn = node.querySelector(".menu-button");
            if (nodeBtn) {
              nodeBtn.setAttribute("aria-expanded", "false");
            }
          }
        });
      }

      selects.forEach(function (select) {
        var button = select.querySelector(".menu-button");
        var label = select.querySelector(".button-label");
        var hiddenInput = select.querySelector("input[type='hidden']");
        var options = select.querySelectorAll(".menu-option");

        if (!button || !options.length || !label) {
          return;
        }

        button.addEventListener("click", function (event) {
          event.preventDefault();
          var willOpen = !select.classList.contains("open");
          closeAll(select);
          select.classList.toggle("open", willOpen);
          button.setAttribute("aria-expanded", String(willOpen));
        });

        options.forEach(function (option) {
          option.addEventListener("click", function () {
            options.forEach(function (opt) {
              opt.classList.remove("active");
            });

            option.classList.add("active");

            var nextLabel = option.getAttribute("data-label") || option.textContent.trim();
            var nextValue = option.getAttribute("data-value") || nextLabel;

            label.textContent = nextLabel;
            if (hiddenInput) {
              hiddenInput.value = nextValue;
            }

            select.classList.remove("open");
            button.setAttribute("aria-expanded", "false");
          });
        });
      });

      document.addEventListener("click", function (event) {
        if (!event.target.closest(".menu-select")) {
          closeAll(null);
        }
      });

      document.addEventListener("keydown", function (event) {
        if (event.key === "Escape") {
          closeAll(null);
        }
      });
    });
  </script>
</body>
</html>


