<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="../CSS/styles.css">
  <title>Contractor Management</title>
  <style>
    :root {
      --bg: #edf1f5;
      --panel: #f8fafc;
      --line: #cfd6de;
      --text: #10253d;
      --muted: #556c86;
      --primary: #14375e;
      --selected: #f7b333;
      --shadow: 0 1px 6px rgba(8, 34, 61, 0.12);
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: "Sora", "Segoe UI", sans-serif;
      background: var(--bg);
      color: var(--text);
      line-height: 1.35;
    }

    body.modal-open {
      overflow: hidden;
    }

    .contractor-page {
      width: 100%;
      max-width: 1380px;
      margin: 0 auto;
      min-height: 100vh;
      padding: clamp(12px, 1.8vw, 28px);
    }

    .contractor-title {
      margin: 0 0 14px;
      font-size: clamp(1.5rem, 1vw + 1rem, 2.1rem);
      line-height: 1.1;
      color: #1a2530;
    }

    .stats-grid {
      display: grid;
      gap: clamp(10px, 1vw, 14px);
      grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
    }

    .stat-card {
      min-height: clamp(110px, 14vw, 134px);
      border: 1px solid var(--line);
      border-radius: 16px;
      background: var(--panel);
      box-shadow: var(--shadow);
      padding: clamp(14px, 1.4vw, 20px);
      display: flex;
      align-items: center;
      gap: 14px;
    }

    .stat-icon {
      width: 46px;
      height: 46px;
      border-radius: 14px;
      display: grid;
      place-items: center;
      flex: 0 0 auto;
    }

    .stat-icon svg {
      width: 22px;
      height: 22px;
    }

    .stat-icon.contractors {
      background: #e4e9ef;
      color: #1e3e61;
    }

    .stat-icon.active {
      background: #d9f0ed;
      color: #00a69b;
    }

    .stat-icon.rating {
      background: #f7ecd8;
      color: #f39b00;
    }

    .stat-icon.blacklisted {
      background: #f6e0e2;
      color: #ff3344;
    }

    .stat-value {
      margin: 0;
      font-size: clamp(2rem, 1vw + 1.35rem, 2.35rem);
      line-height: 1;
      font-weight: 700;
      color: #10253d;
    }

    .stat-label {
      margin: 4px 0 0;
      font-size: 1.02rem;
      color: #4f657f;
      line-height: 1.2;
    }

    .filters-panel {
      margin-top: 18px;
      border: 1px solid var(--line);
      border-radius: 16px;
      background: var(--panel);
      box-shadow: var(--shadow);
      padding: clamp(12px, 1.5vw, 18px);
    }

    .filter-row {
      display: grid;
      gap: 12px;
      align-items: center;
      grid-template-columns: minmax(260px, 1fr) minmax(150px, 185px) minmax(150px, 185px) auto;
    }

    .search-box {
      min-height: 46px;
      border: 1px solid #c7d0db;
      border-radius: 11px;
      background: #f8fafc;
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 9px 12px;
    }

    .search-box svg {
      width: 18px;
      height: 18px;
      color: #6d8095;
      flex: 0 0 auto;
    }

    .search-box input {
      width: 100%;
      border: 0;
      outline: none;
      background: transparent;
      color: #2f4762;
      font-size: 1rem;
      font-family: inherit;
    }

    .menu-select {
      position: relative;
      min-width: 0;
    }

    .menu-button {
      width: 100%;
      min-height: 46px;
      border: 1px solid #c7d0db;
      border-radius: 11px;
      background: #f8fafc;
      color: #3a506a;
      padding: 9px 12px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
      font-family: inherit;
      font-size: 1rem;
      line-height: 1.2;
      cursor: pointer;
    }

    .button-label {
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .menu-button svg {
      width: 15px;
      height: 15px;
      color: #96a4b4;
      flex: 0 0 auto;
      transition: transform 0.2s ease;
    }

    .menu-select.open .menu-button svg {
      transform: rotate(180deg);
    }

    .menu-list {
      display: none;
      position: absolute;
      top: calc(100% + 6px);
      left: 0;
      width: 100%;
      min-width: 150px;
      max-height: min(320px, 60vh);
      overflow: auto;
      border: 1px solid #c7d0db;
      border-radius: 11px;
      background: #f8fafc;
      box-shadow: 0 10px 24px rgba(8, 34, 61, 0.18);
      padding: 6px;
      z-index: 50;
    }

    .menu-select.open .menu-list {
      display: block;
    }

    .menu-option {
      width: 100%;
      min-height: 38px;
      border: 0;
      border-radius: 8px;
      background: transparent;
      color: #1e2f41;
      padding: 8px 10px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
      text-align: left;
      font-family: inherit;
      font-size: 0.98rem;
      cursor: pointer;
    }

    .menu-option:hover {
      background: #ebf0f6;
    }

    .menu-option.active {
      background: var(--selected);
    }

    .option-check {
      opacity: 0;
      font-weight: 700;
      color: #1f2c3f;
    }

    .menu-option.active .option-check {
      opacity: 1;
    }

    .btn-add {
      min-height: 46px;
      border: 0;
      border-radius: 10px;
      background: var(--primary);
      color: #ffffff;
      padding: 10px 16px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 9px;
      font-family: inherit;
      font-size: 1.04rem;
      font-weight: 600;
      cursor: pointer;
      white-space: nowrap;
    }

    .btn-add span:first-child {
      font-size: 1.2rem;
      line-height: 1;
    }

    .contractor-modal-overlay {
      position: fixed;
      inset: 0;
      display: none;
      align-items: center;
      justify-content: center;
      padding: 16px;
      background: rgba(12, 28, 44, 0.45);
      z-index: 1200;
    }

    .contractor-modal-overlay.open {
      display: flex;
    }

    .contractor-modal {
      width: min(100%, 820px);
      max-height: calc(100vh - 24px);
      overflow: auto;
      -webkit-overflow-scrolling: touch;
      border: 1px solid #c7d1dc;
      border-radius: 14px;
      background: #f7f9fc;
      box-shadow: 0 24px 48px rgba(13, 28, 45, 0.26);
      padding: 18px 22px 22px;
    }

    .contractor-modal-head {
      display: flex;
      align-items: flex-start;
      justify-content: space-between;
      gap: 12px;
      margin-bottom: 14px;
    }

    .contractor-modal-head h2 {
      margin: 0;
      font-size: clamp(1.45rem, 1vw + 1rem, 1.95rem);
      line-height: 1.2;
    }

    .contractor-modal-head p {
      margin: 6px 0 0;
      color: #607287;
      font-size: 1rem;
    }

    .contractor-close {
      width: 30px;
      height: 30px;
      border: 0;
      border-radius: 8px;
      background: transparent;
      color: #6f7f90;
      font-size: 1.4rem;
      line-height: 1;
      display: grid;
      place-items: center;
      cursor: pointer;
      flex: 0 0 auto;
    }

    .contractor-close:hover {
      background: #e9edf3;
    }

    .contractor-form {
      display: flex;
      flex-direction: column;
      gap: 14px;
    }

    .form-title {
      margin: 0;
      font-size: 1.75rem;
      line-height: 1.15;
      color: #12273f;
    }

    .form-section-title {
      margin: 2px 0 0;
      font-size: 1.75rem;
      line-height: 1.15;
      color: #12273f;
    }

    .form-divider {
      margin: 2px 0;
      border: 0;
      border-top: 1px solid #d5dde6;
    }

    .form-grid {
      display: grid;
      gap: 12px;
    }

    .form-grid.two {
      grid-template-columns: repeat(2, minmax(0, 1fr));
    }

    .form-grid.three {
      grid-template-columns: repeat(3, minmax(0, 1fr));
    }

    .form-grid.one {
      grid-template-columns: 1fr;
    }

    .form-field {
      display: flex;
      flex-direction: column;
      gap: 7px;
    }

    .form-field > span {
      color: #23384f;
      font-size: 0.98rem;
      font-weight: 600;
      line-height: 1.2;
    }

    .form-field input,
    .form-field select,
    .form-field textarea {
      width: 100%;
      min-height: 42px;
      border: 1px solid #c7d0db;
      border-radius: 11px;
      background: #f8fafd;
      color: #334b66;
      padding: 0 12px;
      font-family: inherit;
      font-size: 1rem;
      outline: none;
    }

    .form-field textarea {
      min-height: 92px;
      padding: 10px 12px;
      resize: vertical;
    }

    .form-field input::placeholder,
    .form-field textarea::placeholder {
      color: #7a8da2;
    }

    .form-field input:focus,
    .form-field select:focus,
    .form-field textarea:focus {
      border-color: #5d7692;
      box-shadow: 0 0 0 2px rgba(20, 55, 94, 0.18);
    }

    .form-actions {
      display: flex;
      justify-content: flex-end;
      gap: 10px;
      margin-top: 4px;
    }

    .form-btn {
      min-height: 42px;
      border-radius: 11px;
      padding: 10px 20px;
      font-family: inherit;
      font-size: 1.05rem;
      font-weight: 600;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
    }

    .form-cancel {
      border: 1px solid #c7d0db;
      background: #f8fafd;
      color: #2a3f58;
    }

    .form-submit {
      border: 0;
      background: var(--primary);
      color: #ffffff;
    }

    @media (max-width: 1180px) {
      .filter-row {
        grid-template-columns: repeat(2, minmax(0, 1fr));
      }

      .search-box {
        grid-column: 1 / -1;
      }

      .btn-add {
        justify-self: start;
      }
    }

    @media (max-width: 1024px) {
      .form-grid.three {
        grid-template-columns: repeat(2, minmax(0, 1fr));
      }
    }

    @media (max-width: 840px) {
      .contractor-page {
        padding: 12px;
      }

      .stats-grid {
        grid-template-columns: repeat(2, minmax(0, 1fr));
      }

      .filter-row {
        grid-template-columns: 1fr;
      }

      .search-box {
        grid-column: auto;
      }

      .btn-add {
        width: 100%;
      }

      .contractor-modal {
        width: min(100%, 720px);
      }
    }

    @media (max-width: 640px) {
      .contractor-page {
        padding: 10px;
      }

      .stats-grid,
      .form-grid.two,
      .form-grid.three {
        grid-template-columns: 1fr;
      }

      .stat-card {
        min-height: 98px;
        padding: 12px;
      }

      .stat-icon {
        width: 40px;
        height: 40px;
        border-radius: 12px;
      }

      .stat-icon svg {
        width: 19px;
        height: 19px;
      }

      .contractor-modal-overlay {
        padding: 10px;
      }

      .contractor-modal {
        max-height: calc(100vh - 20px);
        padding: 14px;
      }

      .contractor-modal-head {
        margin-bottom: 10px;
      }

      .form-title,
      .form-section-title {
        font-size: 1.35rem;
      }

      .form-actions {
        justify-content: stretch;
      }

      .form-btn {
        flex: 1;
      }
    }

    @media (max-width: 420px) {
      .contractor-title {
        font-size: 1.3rem;
      }

      .menu-list {
        min-width: 100%;
      }

      .menu-button,
      .search-box,
      .btn-add {
        min-height: 44px;
      }

      .form-actions {
        flex-direction: column-reverse;
      }
    }
  </style>
</head>
<body>
  <main class="contractor-page">
    <h1 class="contractor-title">Contractor Management</h1>

    <section class="stats-grid" aria-label="Contractor summary cards">
      <article class="stat-card">
        <div class="stat-icon contractors" aria-hidden="true">
          <svg viewBox="0 0 24 24" fill="none"><path d="M5 5h8v14H5z" stroke="currentColor" stroke-width="2"/><path d="M13 9h6v10h-6z" stroke="currentColor" stroke-width="2"/><path d="M8 9h2M8 13h2M8 17h2M16 13h1M16 17h1" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
        </div>
        <div>
          <p class="stat-value">0</p>
          <p class="stat-label">Total Contractors</p>
        </div>
      </article>

      <article class="stat-card">
        <div class="stat-icon active" aria-hidden="true">
          <svg viewBox="0 0 24 24" fill="none"><circle cx="12" cy="12" r="9" stroke="currentColor" stroke-width="2"/><path d="m9.5 12 1.7 1.7L15 10" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
        </div>
        <div>
          <p class="stat-value">0</p>
          <p class="stat-label">Active</p>
        </div>
      </article>

      <article class="stat-card">
        <div class="stat-icon rating" aria-hidden="true">
          <svg viewBox="0 0 24 24" fill="none"><path d="m12 3 2.8 5.7 6.2.9-4.5 4.4 1 6.2L12 17.4 6.5 20.2l1-6.2L3 9.6l6.2-.9L12 3Z" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/></svg>
        </div>
        <div>
          <p class="stat-value">0.0</p>
          <p class="stat-label">Avg Rating</p>
        </div>
      </article>

      <article class="stat-card">
        <div class="stat-icon blacklisted" aria-hidden="true">
          <svg viewBox="0 0 24 24" fill="none"><path d="M12 4 3.5 19h17L12 4Z" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/><path d="M12 10v4M12 18h.01" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
        </div>
        <div>
          <p class="stat-value">0</p>
          <p class="stat-label">Blacklisted</p>
        </div>
      </article>
    </section>

    <section class="filters-panel" aria-label="Contractor filters">
      <div class="filter-row">
        <label class="search-box" for="contractorSearch">
          <svg viewBox="0 0 24 24" fill="none" aria-hidden="true"><circle cx="11" cy="11" r="6.5" stroke="currentColor" stroke-width="2"/><path d="M16 16L21 21" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
          <input id="contractorSearch" type="search" placeholder="Search by name, TIN, PhilGEPS, PCAB..." autocomplete="off">
        </label>

        <div class="menu-select" data-name="status">
          <input type="hidden" name="status" value="all">
          <button type="button" class="menu-button" aria-expanded="false" aria-haspopup="listbox">
            <span class="button-label">All Status</span>
            <svg viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="m6 9 6 6 6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
          </button>
          <div class="menu-list" role="listbox">
            <button type="button" class="menu-option active" data-value="all" data-label="All Status"><span>All Status</span><span class="option-check">&#10003;</span></button>
            <button type="button" class="menu-option" data-value="active" data-label="Active"><span>Active</span><span class="option-check">&#10003;</span></button>
            <button type="button" class="menu-option" data-value="blacklisted" data-label="Blacklisted"><span>Blacklisted</span><span class="option-check">&#10003;</span></button>
            <button type="button" class="menu-option" data-value="suspended" data-label="Suspended"><span>Suspended</span><span class="option-check">&#10003;</span></button>
            <button type="button" class="menu-option" data-value="inactive" data-label="Inactive"><span>Inactive</span><span class="option-check">&#10003;</span></button>
          </div>
        </div>

        <div class="menu-select" data-name="pcab">
          <input type="hidden" name="pcab" value="all">
          <button type="button" class="menu-button" aria-expanded="false" aria-haspopup="listbox">
            <span class="button-label">All PCAB</span>
            <svg viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="m6 9 6 6 6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
          </button>
          <div class="menu-list" role="listbox">
            <button type="button" class="menu-option active" data-value="all" data-label="All PCAB"><span>All PCAB</span><span class="option-check">&#10003;</span></button>
            <button type="button" class="menu-option" data-value="aaa" data-label="Category AAA"><span>Category AAA</span><span class="option-check">&#10003;</span></button>
            <button type="button" class="menu-option" data-value="aa" data-label="Category AA"><span>Category AA</span><span class="option-check">&#10003;</span></button>
            <button type="button" class="menu-option" data-value="a" data-label="Category A"><span>Category A</span><span class="option-check">&#10003;</span></button>
            <button type="button" class="menu-option" data-value="b" data-label="Category B"><span>Category B</span><span class="option-check">&#10003;</span></button>
            <button type="button" class="menu-option" data-value="c" data-label="Category C"><span>Category C</span><span class="option-check">&#10003;</span></button>
            <button type="button" class="menu-option" data-value="d" data-label="Category D"><span>Category D</span><span class="option-check">&#10003;</span></button>
          </div>
        </div>

        <button type="button" class="btn-add" id="openContractorModal"><span>+</span><span>Add Contractor</span></button>
      </div>
    </section>
  </main>

  <div class="contractor-modal-overlay" id="contractorModal" aria-hidden="true">
    <div class="contractor-modal" role="dialog" aria-modal="true" aria-labelledby="contractorModalTitle">
      <div class="contractor-modal-head">
        <div>
          <h2 id="contractorModalTitle" class="form-title">Add New Contractor</h2>
          <p>Register a new contractor in the system</p>
        </div>
        <button type="button" class="contractor-close" id="closeContractorModal" aria-label="Close">&#215;</button>
      </div>

      <form class="contractor-form" id="contractorForm">
        <div class="form-grid two">
          <label class="form-field">
            <span>Company Name *</span>
            <input id="contractorCompanyName" type="text" placeholder="Full company name" required>
          </label>

          <label class="form-field">
            <span>Trade Name</span>
            <input type="text" placeholder="DBA / Trade name">
          </label>
        </div>

        <hr class="form-divider">
        <h3 class="form-section-title">Registration Details</h3>

        <div class="form-grid two">
          <label class="form-field">
            <span>TIN</span>
            <input type="text" placeholder="Tax ID Number">
          </label>

          <label class="form-field">
            <span>PhilGEPS Number</span>
            <input type="text" placeholder="PhilGEPS registration">
          </label>
        </div>

        <div class="form-grid three">
          <label class="form-field">
            <span>PCAB License</span>
            <input type="text" placeholder="License number">
          </label>

          <label class="form-field">
            <span>PCAB Category</span>
            <select>
              <option value="" selected>Select</option>
              <option value="aaa">Category AAA</option>
              <option value="aa">Category AA</option>
              <option value="a">Category A</option>
              <option value="b">Category B</option>
              <option value="c">Category C</option>
              <option value="d">Category D</option>
            </select>
          </label>

          <label class="form-field">
            <span>License Expiry</span>
            <input type="date">
          </label>
        </div>

        <div class="form-grid one">
          <label class="form-field">
            <span>PCAB Classification</span>
            <input type="text" placeholder="e.g., General Engineering, General Building">
          </label>
        </div>

        <hr class="form-divider">
        <h3 class="form-section-title">Contact Information</h3>

        <div class="form-grid one">
          <label class="form-field">
            <span>Address</span>
            <input type="text" placeholder="Street address">
          </label>
        </div>

        <div class="form-grid two">
          <label class="form-field">
            <span>City/Municipality</span>
            <input type="text">
          </label>

          <label class="form-field">
            <span>Province</span>
            <input type="text">
          </label>
        </div>

        <div class="form-grid two">
          <label class="form-field">
            <span>Contact Person</span>
            <input type="text">
          </label>

          <label class="form-field">
            <span>Email</span>
            <input type="email">
          </label>
        </div>

        <div class="form-grid two">
          <label class="form-field">
            <span>Phone</span>
            <input type="text">
          </label>

          <label class="form-field">
            <span>Mobile</span>
            <input type="text">
          </label>
        </div>

        <div class="form-grid one">
          <label class="form-field">
            <span>Remarks</span>
            <textarea></textarea>
          </label>
        </div>

        <div class="form-actions">
          <button type="button" class="form-btn form-cancel" id="cancelContractorModal">Cancel</button>
          <button type="submit" class="form-btn form-submit">Create</button>
        </div>
      </form>
    </div>
  </div>

  <script>
    document.addEventListener("DOMContentLoaded", function () {
      var selects = document.querySelectorAll(".menu-select");
      var modal = document.getElementById("contractorModal");
      var openModalBtn = document.getElementById("openContractorModal");
      var closeModalBtn = document.getElementById("closeContractorModal");
      var cancelModalBtn = document.getElementById("cancelContractorModal");
      var contractorForm = document.getElementById("contractorForm");
      var companyNameField = document.getElementById("contractorCompanyName");

      function closeAllSelects(exceptNode) {
        selects.forEach(function (node) {
          if (node !== exceptNode) {
            node.classList.remove("open");
            var nodeBtn = node.querySelector(".menu-button");
            if (nodeBtn) {
              nodeBtn.setAttribute("aria-expanded", "false");
            }
          }
        });
      }

      function openContractorModal() {
        if (!modal) {
          return;
        }
        closeAllSelects(null);
        modal.classList.add("open");
        modal.setAttribute("aria-hidden", "false");
        document.body.classList.add("modal-open");
        if (companyNameField) {
          window.setTimeout(function () {
            companyNameField.focus();
          }, 0);
        }
      }

      function closeContractorModal() {
        if (!modal) {
          return;
        }
        modal.classList.remove("open");
        modal.setAttribute("aria-hidden", "true");
        document.body.classList.remove("modal-open");
      }

      selects.forEach(function (select) {
        var button = select.querySelector(".menu-button");
        var label = select.querySelector(".button-label");
        var hiddenInput = select.querySelector("input[type='hidden']");
        var options = select.querySelectorAll(".menu-option");

        if (!button || !label || !options.length) {
          return;
        }

        button.addEventListener("click", function (event) {
          event.preventDefault();
          var willOpen = !select.classList.contains("open");
          closeAllSelects(select);
          select.classList.toggle("open", willOpen);
          button.setAttribute("aria-expanded", String(willOpen));
        });

        options.forEach(function (option) {
          option.addEventListener("click", function () {
            options.forEach(function (item) {
              item.classList.remove("active");
            });

            option.classList.add("active");
            var nextLabel = option.getAttribute("data-label") || option.textContent.trim();
            var nextValue = option.getAttribute("data-value") || nextLabel;

            label.textContent = nextLabel;
            if (hiddenInput) {
              hiddenInput.value = nextValue;
            }

            select.classList.remove("open");
            button.setAttribute("aria-expanded", "false");
          });
        });
      });

      document.addEventListener("click", function (event) {
        if (!event.target.closest(".menu-select")) {
          closeAllSelects(null);
        }
      });

      if (openModalBtn) {
        openModalBtn.addEventListener("click", openContractorModal);
      }

      if (closeModalBtn) {
        closeModalBtn.addEventListener("click", closeContractorModal);
      }

      if (cancelModalBtn) {
        cancelModalBtn.addEventListener("click", closeContractorModal);
      }

      if (contractorForm) {
        contractorForm.addEventListener("submit", function (event) {
          event.preventDefault();
          closeContractorModal();
        });
      }

      if (modal) {
        modal.addEventListener("click", function (event) {
          if (event.target === modal) {
            closeContractorModal();
          }
        });
      }

      document.addEventListener("keydown", function (event) {
        if (event.key === "Escape") {
          closeAllSelects(null);
          closeContractorModal();
        }
      });
    });
  </script>
</body>
</html>

